{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component } from '@angular/core';\nimport { ApiService } from '../../services/api.service';\nlet CreateOrderComponent = class CreateOrderComponent {\n  constructor(api) {\n    this.api = api;\n    this.clients = [];\n    this.products = [];\n    this.selectedClientId = null;\n  }\n  ngOnInit() {\n    this.api.getClients().subscribe(cs => this.clients = cs || []);\n    this.api.getProducts().subscribe(ps => {\n      // garante quantidade inicial e flag selected\n      this.products = (ps || []).map(p => ({\n        ...p,\n        quantidade: 1,\n        selected: false\n      }));\n    });\n  }\n  createOrder() {\n    if (!this.selectedClientId) {\n      alert('Escolha um cliente');\n      return;\n    }\n    // monta lista apenas com produtos selecionados e quantidade > 0\n    const itens = this.products.filter(p => p.selected).map(p => ({\n      id: p.id,\n      quantidade: Number(p.quantidade) || 0 // força number\n    })).filter(p => p.quantidade > 0);\n    if (itens.length === 0) {\n      alert('Escolha ao menos 1 produto com quantidade >= 1');\n      return;\n    }\n    const dto = {\n      clienteId: this.selectedClientId,\n      produtos: itens\n    };\n    this.api.createOrder(dto).subscribe({\n      next: _ => {\n        alert('Pedido criado');\n        // opcional: limpar seleção\n        this.products.forEach(p => {\n          p.selected = false;\n          p.quantidade = 1;\n        });\n      },\n      error: e => {\n        console.error(e);\n        alert('Erro ao criar pedido');\n      }\n    });\n  }\n};\nCreateOrderComponent = __decorate([Component({\n  selector: 'app-create-order',\n  templateUrl: './create-order.component.html'\n}), __metadata(\"design:paramtypes\", [ApiService])], CreateOrderComponent);\nexport { CreateOrderComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}